// Di dalam doGet(e) atau doPost(e) Apps Script Anda
if (action === 'getLiveWorkload') {
  const sheet = ss.getSheetByName('Booking');
  const data = sheet.getDataRange().getValues();
  let hasil = [];
  
  for (let i = 1; i < data.length; i++) {
    let status = data[i][4].toString().toUpperCase();
    if (status.includes('PROSES') || status.includes('TUNGGU')) {
      hasil.push({
        nama: data[i][0].substring(0, 3) + "***", // Sensor nama demi privasi
        pekerjaan: data[i][2],
        tanggal: Utilities.formatDate(new Date(data[i][3]), "GMT+7", "dd MMM"),
        status: data[i][4]
      });
    }
  }
  return ContentService.createTextOutput(JSON.stringify({status: 'success', data: hasil.reverse()}))
    .setMimeType(ContentService.MimeType.JSON);
}
